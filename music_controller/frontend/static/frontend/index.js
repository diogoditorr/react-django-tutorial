import{j as w,R as H,r as o,u as b,a as F,G as t,T as x,F as _,b as j,c as N,d as G,e as B,f as V,B as m,L as E,g as q,h as A,C as J,A as O,i as L,S as M,k as T,l as X}from"./assets/vendor.ad77a65d.js";const e=w.exports.jsx,r=w.exports.jsxs,R=H.createContext({});function U(a){const[s,n]=o.exports.useState(""),[c,v]=o.exports.useState({votesToSkip:2,guestCanPause:!0});async function S(p){const l=await fetch("/api/get-room?code="+p);return{data:await l.json(),response:l}}return e(R.Provider,{value:{defaultRoomProps:c,roomCode:s,getRoomDetails:S,setRoomCode:n},children:a.children})}function $(){const a=b(),{setRoomCode:s,defaultRoomProps:n}=o.exports.useContext(R),[c,v,S]=F(["csrftoken"]),[p,l]=o.exports.useState(n.guestCanPause),[d,g]=o.exports.useState(n.votesToSkip);function i(h){g(Number(h.target.value))}function C(h){l(h.target.value==="true")}function f(){const h={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":c.csrftoken},body:JSON.stringify({votes_to_skip:d,guest_can_pause:p})};fetch("/api/create-room",h).then(u=>u.json()).then(u=>{u.code===null?a.push("/"):(s(u.code),a.push("/room/"+u.code))})}return r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{component:"h4",variant:"h4",children:"Create a Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(_,{component:"fieldset",children:[e(j,{children:e("span",{children:"Guest Control of Playback State"})}),r(N,{row:!0,defaultValue:n.guestCanPause.toString(),onChange:C,children:[e(G,{value:"true",control:e(B,{color:"primary"}),label:"Play/Pause",labelPlacement:"bottom"}),e(G,{value:"false",control:e(B,{color:"secondary"}),label:"No control",labelPlacement:"bottom"})]})]})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(_,{children:[e(V,{required:!0,type:"number",defaultValue:d,inputProps:{min:1,style:{textAlign:"center"}},onChange:i}),e(j,{children:e("span",{children:"Votes Required To Skip Song"})})]})}),r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{color:"primary",variant:"contained",onClick:f,children:"Create A Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{color:"secondary",variant:"contained",to:"/",component:E,children:"Back"})})]})]})}function z(){const{setRoomCode:a}=o.exports.useContext(R),s=b();return o.exports.useEffect(()=>{fetch("/api/user-in-room").then(n=>n.json()).then(n=>{n.code!==null&&(a(n.code),s.push("/room/"+n.code))})},[]),r(t,{container:!0,spacing:3,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{variant:"h3",children:"House Party"})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(q,{disableElevation:!0,variant:"contained",color:"primary",children:[e(m,{color:"primary",to:"/join",component:E,children:"Join a Room"}),e(m,{color:"secondary",to:"/create",component:E,children:"Create a Room"})]})})]})}function K(){const a=b(),{roomCode:s}=A(),{setRoomCode:n,getRoomDetails:c}=o.exports.useContext(R),[v,S,p]=F(["csrftoken"]),[l,d]=o.exports.useState(2),[g,i]=o.exports.useState(!1),[C,f]=o.exports.useState(!1);function h(){fetch("/api/leave-room",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":v.csrftoken}}).then(I=>{u(),a.push("/")})}function u(){n("")}return o.exports.useEffect(()=>{async function I(){const y=await c(s);y.response.status!==200&&(u(),a.push("/")),d(y.data.votes_to_skip),i(y.data.guest_can_pause),f(y.data.is_host),n(s)}I()},[]),r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:r(x,{variant:"h4",component:"h4",children:["Code: ",s]})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(x,{variant:"h6",component:"h6",children:["Votes: ",l]})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(x,{variant:"h6",component:"h6",children:["Guest Can Pause: ",g?"yes":"no"]})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(x,{variant:"h6",component:"h6",children:["Host: ",C?"yes":"no"]})}),C?e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"primary",onClick:()=>a.push(`/room/${s}/settings`),children:"Settings"})}):"",e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"secondary",onClick:h,children:"Leave Room"})})]})}function Q(){const a=b(),{roomCode:s,setRoomCode:n}=o.exports.useContext(R),[c,v,S]=F(["csrftoken"]),[p,l]=o.exports.useState("");function d(i){n(i.target.value)}function g(){fetch("/api/join-room",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":c.csrftoken},body:JSON.stringify({code:s})}).then(i=>{i.ok?a.push(`/room/${s}`):l("Room not found.")}).catch(i=>{console.log(i)})}return r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{variant:"h4",component:"h4",children:"Join a Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(V,{error:!!p,label:"Code",placeholder:"Enter a Room Code",value:s,helperText:p,variant:"outlined",onChange:d})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"primary",onClick:g,children:"Enter Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"secondary",to:"/",component:E,children:"Back"})})]})}function W(){const a=b(),{getRoomDetails:s,defaultRoomProps:n}=o.exports.useContext(R),{roomCode:c}=A(),[v,S,p]=F(["csrftoken"]),[l,d]=o.exports.useState(n.guestCanPause),[g,i]=o.exports.useState(n.votesToSkip),[C,f]=o.exports.useState(""),[h,u]=o.exports.useState(!1);function I(k){i(Number(k.target.value))}function y(k){d(k.target.value==="true")}function D(){const k={method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":v.csrftoken},body:JSON.stringify({votes_to_skip:g,guest_can_pause:l,code:c})};fetch("/api/update-room",k).then(P=>{P.ok?(u(!1),f("Room updated successfully!")):(u(!0),f("Error updating room..."))})}return o.exports.useEffect(()=>{async function k(){const P=await s(c);P.response.status!==200&&a.push("/"),d(P.data.guest_can_pause),i(P.data.votes_to_skip)}k()},[]),r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:r(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(J,{in:C!="",children:h===!0?e(O,{severity:"error",onClose:()=>f(""),children:C}):e(O,{severity:"success",onClose:()=>f(""),children:C})})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{component:"h4",variant:"h4",children:"Update Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(_,{component:"fieldset",children:[e(j,{children:e("span",{children:"Guest Control of Playback State"})}),r(N,{row:!0,value:l.toString(),onChange:y,children:[e(G,{value:"true",control:e(B,{color:"primary"}),label:"Play/Pause",labelPlacement:"bottom"}),e(G,{value:"false",control:e(B,{color:"secondary"}),label:"No control",labelPlacement:"bottom"})]})]})}),e(t,{item:!0,xs:12,alignItems:"center",children:r(_,{children:[e(V,{required:!0,type:"number",value:g,inputProps:{min:1,style:{textAlign:"center"}},onChange:I}),e(j,{children:e("span",{children:"Votes Required To Skip Song"})})]})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{color:"primary",variant:"contained",onClick:D,children:"Update Room"})})]})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"secondary",onClick:()=>a.push(`/room/${c}`),children:"Go back"})})]})}function Y(){return e("div",{className:"center",children:e(U,{children:e(L,{children:r(M,{children:[e(T,{path:"/",exact:!0,component:z}),e(T,{path:"/join",component:Q}),e(T,{path:"/create",component:$}),e(T,{path:"/room/:roomCode",exact:!0,component:K}),e(T,{path:"/room/:roomCode/settings",component:W})]})})})})}X.render(e(H.StrictMode,{children:e(Y,{})}),document.getElementById("app"));
