import{j as w,R as H,r as o,u as T,a as F,G as t,T as x,F as _,b as j,c as N,d as G,e as B,f as V,B as m,L as E,g as J,h as A,C as L,A as O,i as D,S as M,k as P,l as X}from"./assets/vendor.ad77a65d.js";const e=w.exports.jsx,n=w.exports.jsxs,b=H.createContext({});function U(r){const[a,i]=o.exports.useState(""),[s,v]=o.exports.useState({votesToSkip:2,guestCanPause:!0});async function R(p){const l=await fetch("/api/get-room?code="+p);return{data:await l.json(),response:l}}return e(b.Provider,{value:{defaultRoomProps:s,roomCode:a,getRoom:R,setRoomCode:i},children:r.children})}function $(){const r=T(),{setRoomCode:a,defaultRoomProps:i}=o.exports.useContext(b),[s,v,R]=F(["csrftoken"]),[p,l]=o.exports.useState(i.guestCanPause),[d,C]=o.exports.useState(i.votesToSkip);function c(h){C(Number(h.target.value))}function g(h){l(h.target.value==="true")}function f(){const h={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":s.csrftoken},body:JSON.stringify({votes_to_skip:d,guest_can_pause:p})};fetch("/api/create-room",h).then(u=>u.json()).then(u=>{u.code===null?r.push("/"):(a(u.code),r.push("/room/"+u.code))})}return n(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{component:"h4",variant:"h4",children:"Create a Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:n(_,{component:"fieldset",children:[e(j,{children:e("span",{children:"Guest Control of Playback State"})}),n(N,{row:!0,defaultValue:i.guestCanPause.toString(),onChange:g,children:[e(G,{value:"true",control:e(B,{color:"primary"}),label:"Play/Pause",labelPlacement:"bottom"}),e(G,{value:"false",control:e(B,{color:"secondary"}),label:"No control",labelPlacement:"bottom"})]})]})}),e(t,{item:!0,xs:12,alignItems:"center",children:n(_,{children:[e(V,{required:!0,type:"number",defaultValue:d,inputProps:{min:1,style:{textAlign:"center"}},onChange:c}),e(j,{children:e("span",{children:"Votes Required To Skip Song"})})]})}),n(t,{container:!0,spacing:1,children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{color:"primary",variant:"contained",onClick:f,children:"Create A Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{color:"secondary",variant:"contained",to:"/",component:E,children:"Back"})})]})]})}function z(){const{roomCode:r,setRoomCode:a}=o.exports.useContext(b),i=T();return o.exports.useEffect(()=>{console.log("Room Code:",r),r?i.push("/room/"+r):fetch("/api/user-in-room").then(s=>s.json()).then(s=>{s.code!==null&&(a(s.code),i.push("/room/"+s.code))})},[]),n(t,{container:!0,spacing:3,direction:"column",alignItems:"center",children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{variant:"h3",children:"House Party"})}),e(t,{item:!0,xs:12,alignItems:"center",children:n(J,{disableElevation:!0,variant:"contained",color:"primary",children:[e(m,{color:"primary",to:"/join",component:E,children:"Join a Room"}),e(m,{color:"secondary",to:"/create",component:E,children:"Create a Room"})]})})]})}function K(){const r=T(),{roomCode:a}=A(),{setRoomCode:i,getRoom:s}=o.exports.useContext(b),[v,R,p]=F(["csrftoken"]),[l,d]=o.exports.useState(2),[C,c]=o.exports.useState(!1),[g,f]=o.exports.useState(!1);function h(){fetch("/api/leave-room",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":v.csrftoken}}).then(I=>{u(),r.push("/")})}function u(){i("")}return o.exports.useEffect(()=>{async function I(){const y=await s(a);y.response.status!==200&&(u(),r.push("/")),d(y.data.votes_to_skip),c(y.data.guest_can_pause),f(y.data.is_host),i(a)}I()},[]),n(t,{container:!0,spacing:1,direction:"column",alignItems:"center",children:[e(t,{item:!0,xs:12,children:n(x,{variant:"h4",component:"h4",children:["Code: ",a]})}),e(t,{item:!0,xs:12,children:n(x,{variant:"h6",component:"h6",children:["Votes: ",l]})}),e(t,{item:!0,xs:12,children:n(x,{variant:"h6",component:"h6",children:["Guest Can Pause: ",C?"yes":"no"]})}),e(t,{item:!0,xs:12,children:n(x,{variant:"h6",component:"h6",children:["Host: ",g?"yes":"no"]})}),g?e(t,{item:!0,xs:12,children:e(m,{variant:"contained",color:"primary",onClick:()=>r.push(`/room/${a}/settings`),children:"Settings"})}):"",e(t,{item:!0,xs:12,children:e(m,{variant:"contained",color:"secondary",onClick:h,children:"Leave Room"})})]})}function Q(){const r=T(),[a,i]=o.exports.useState(""),[s,v,R]=F(["csrftoken"]),[p,l]=o.exports.useState("");function d(c){i(c.target.value)}function C(){fetch("/api/join-room",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":s.csrftoken},body:JSON.stringify({code:a})}).then(c=>{c.ok?r.push(`/room/${a}`):l("Room not found.")}).catch(c=>{console.log(c)})}return n(t,{container:!0,spacing:1,direction:"column",alignItems:"center",children:[e(t,{item:!0,xs:12,alignItems:"center",children:e(x,{variant:"h4",component:"h4",children:"Join a Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(V,{error:!!p,label:"Code",placeholder:"Enter a Room Code",value:a,helperText:p,variant:"outlined",onChange:d})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"primary",onClick:C,children:"Enter Room"})}),e(t,{item:!0,xs:12,alignItems:"center",children:e(m,{variant:"contained",color:"secondary",to:"/",component:E,children:"Back"})})]})}function W(){const r=T(),{getRoom:a,defaultRoomProps:i}=o.exports.useContext(b),{roomCode:s}=A(),[v,R,p]=F(["csrftoken"]),[l,d]=o.exports.useState(i.guestCanPause),[C,c]=o.exports.useState(i.votesToSkip),[g,f]=o.exports.useState(""),[h,u]=o.exports.useState(!1);function I(k){c(Number(k.target.value))}function y(k){d(k.target.value==="true")}function q(){const k={method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":v.csrftoken},body:JSON.stringify({votes_to_skip:C,guest_can_pause:l,code:s})};fetch("/api/update-room",k).then(S=>{S.ok?(u(!1),f("Room updated successfully!")):(u(!0),f("Error updating room..."))})}return o.exports.useEffect(()=>{async function k(){const S=await a(s);S.response.status!==200&&r.push("/"),d(S.data.guest_can_pause),c(S.data.votes_to_skip)}k()},[]),n(t,{container:!0,spacing:1,direction:"column",alignItems:"center",children:[e(t,{item:!0,xs:12,children:n(t,{container:!0,spacing:1,direction:"column",alignItems:"center",children:[e(t,{item:!0,xs:12,children:e(L,{in:g!="",children:h===!0?e(O,{severity:"error",onClose:()=>f(""),children:g}):e(O,{severity:"success",onClose:()=>f(""),children:g})})}),e(t,{item:!0,xs:12,children:e(x,{component:"h4",variant:"h4",children:"Update Room"})}),e(t,{item:!0,xs:12,children:n(_,{component:"fieldset",children:[e(j,{children:e("span",{children:"Guest Control of Playback State"})}),n(N,{row:!0,value:l.toString(),onChange:y,children:[e(G,{value:"true",control:e(B,{color:"primary"}),label:"Play/Pause",labelPlacement:"bottom"}),e(G,{value:"false",control:e(B,{color:"secondary"}),label:"No control",labelPlacement:"bottom"})]})]})}),e(t,{item:!0,xs:12,children:n(_,{children:[e(V,{required:!0,type:"number",value:C,inputProps:{min:1,style:{textAlign:"center"}},onChange:I}),e(j,{children:e("span",{children:"Votes Required To Skip Song"})})]})}),e(t,{item:!0,xs:12,children:e(m,{color:"primary",variant:"contained",onClick:q,children:"Update Room"})})]})}),e(t,{item:!0,xs:12,children:e(m,{variant:"contained",color:"secondary",onClick:()=>r.push(`/room/${s}`),children:"Go back"})})]})}function Y(){return e("div",{className:"center",children:e(U,{children:e(D,{children:n(M,{children:[e(P,{path:"/",exact:!0,component:z}),e(P,{path:"/join",component:Q}),e(P,{path:"/create",component:$}),e(P,{path:"/room/:roomCode",exact:!0,component:K}),e(P,{path:"/room/:roomCode/settings",component:W})]})})})})}X.render(e(H.StrictMode,{children:e(Y,{})}),document.getElementById("app"));
